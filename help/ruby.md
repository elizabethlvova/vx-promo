---
layout: help
title: Ruby
---

Для того что бы запустить тестирование руби проекта достаточнобудет указать

    language: ruby

В этом случае будет использоваться версия ``1.9.3`` и выполены команды

    install: bundle install
    script: bundle exec rake

Если вы используете ``rails`` то потребуется настроить преед тестами базу

    before_script:
    - bundle exec rake db:create db:migrate RAILS_ENV=test

Можно указать дополнительные ключи для bundler

    bundler_args: --without debugger

Указать несколько разных Gemfile, если это требуется, тогда будет построена
матрица

    gemfile:
    - Gemfile.pg
    - Gemfile.mysql

Для тестирования доступны версии руби

* ``1.9.3-p547``
* ``2.0.0-p481``
* ``2.1.1``
* ``2.1.2``
* ``jruby-1.7.13``
* ``head``, свежая сборка из репозитория, пересобирается каждую неделю

Для того что выбрать нужную версию для тестирования используется ключ ``rvm``

    rvm:
    - 2.0
    - 2.1
    - head

При выборе версия используется fuzzy matching, поэтому не обязательно указывать полные
версии.

Если по какимто причинам предустановленные версии не устраивают, на тестовой машине
установлен ruby-build, и вы всегда можете собрать нужную вам версию с нужными патчами.

Для руби по умолчанию кэшируются устанавливанемые гемы, при последющем запуске тестов
это позволит съекономить время. Кэширование можно выключить

    cache: false


Для управления версиями ruby мы не используется rbenv или rvm, руби собраны в deb
пакеты, каждая версия в отдельном. При запуске тестов в систему устанавливается
нужная. На тестовой машине ``rbenv`` и ``rvm`` нет. Для сборки и установки кастомизированных
доступен ``ruby-build``, или лучше если вы нам датите занать и мы соберем нужную
вам версию с нужными патчеми в пакет.
